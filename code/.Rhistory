V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Non ci sono voli la cui origine o destinazione non sia in AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
zm()
#### Mini (notAF1)
#### Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Non ci sono voli la cui origine o destinazione non sia in AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (onlyAF1)
#### Voli la cui origine e destinazione è AF1
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code!="AF1" | E(net)$Arr.Region.Code!="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine e destinazione è AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (onlyAF1)
#### Voli la cui origine e destinazione è AF1
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code!="AF1" | E(net)$Arr.Region.Code!="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine e destinazione è AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAlgeris)
#### Voli la cui origine o destinazione non sia Algeris (ALG)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Airport.Name=="Algiers" | E(net)$Arr.Airport.Name=="Algiers"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine o destinazione non sia Algeris (ALG)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (onlyAF1)
#### Voli la cui origine e destinazione è AF1
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code!="AF1" | E(net)$Arr.Region.Code!="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine e destinazione è AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAF1)
#### Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Non ci sono voli la cui origine o destinazione non sia in AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (Algeris (ALG) to AF3, EU2, ME1, NA1, AS4)
#### Voli verso regioni diverse da AF1 e EU1 gestiti da più aeroporti africani
#### Notare un solo aeroporto in EU2 (Siviglia (SVQ))
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Arr.Region.Code=="AF1" | E(net)$Arr.Region.Code=="EU1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli verso regioni diverse da AF1 e EU1 gestiti da più aeroporti africani")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
q()
#############################################################################################################################################
####### Progetto Network Analysis (aa 2020-2021) - GRUPPO 7 SLOT 8 - Air Algerie (AH)
#############################################################################################################################################
############################
####### DATASET 2010 #######
############################
# Importo file nodes2010
## Windows
nodes2010 <- read.csv(file="C:/GitHub/unibg-ers/code/NODES_2010.csv", sep= ";", fileEncoding="UTF-8-BOM")
nodes2010
# Importo file edges2010
## Windows
edges2010 <- read.csv(file="C:/GitHub/unibg-ers/code/EDGES_2010.csv", sep= ";", fileEncoding="UTF-8-BOM")
edges2010
# ZOOM
library(zoom)
#zm()# Chiamare solo dopo aver plottato, per uscire cliccare 'q' sulla figura
# Esamino i dati
head(nodes2010) 
head(edges2010) 
nrow(nodes2010) # 67
length(unique(nodes2010$Airport.Code)) # Tutti i nodi sono unici
nrow(edges2010) # 201
nrow(unique(edges2010[,c("Dep.Airport.Code","Arr.Airport.Code")])) # Tutte le tratte sono uniche
### Rappresenazione grafica
library(igraph)
net<-graph_from_data_frame(d=edges2010,vertices=nodes2010,directed=T)
class(net)
as_edgelist(net,names=T)
# Attenzione per network grandi può far saltare il programma as_adjacency_matrix(net,attr="weight")
as_data_frame(net,what="edges")
as_data_frame(net,what="vertices")
#### Plotto
plot(net,edge.arrow.size=.4,vertex.size=3,vertex.label.cex=.01)
plot(net,edge.arrow.size=.4,vertex.size=3,vertex.label.cex=.5)
plot(net,edge.arrow.size=.4,vertex.label=V(net)$name,vertex.size=3,vertex.label.cex=.5)
plot(net, edge.arrow.size=.4, vertex.shape="none", vertex.label=V(net)$name, vertex.size=3,vertex.label.font=2, vertex.label.color="gray40",vertex.label.cex=.5, edge.color="gray85")
#### Plotto con link curvi
plot(net,edge.arrow.size=.4,vertex.size=.9,edge.curved=.1,vertex.label.cex=.3)
#### Plotto con link non curvi e ridotta dimensione delle frecce
plot(net,edge.arrow.size=.2,edge.curved=0,vertex.color="orange",vertex.frame.color="#555555",vertex.label=V(net)$name,vertex.size=4.9,vertex.label.color="black",vertex.label.cex=.5)
#### Genero colore in base al Region.Code
unique(nodes2010[,c("Region.Code")]) # Region.Code unici: "AF1" "AF3" "ME1" "EU1" "EU2" "NA1" "AS4"
#V(net)$type <- 404
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
plot(net,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.size=10,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Setto la taglia dei nodi in base a size (es. dimensione aeroporto per seats totali nel network)
#V(net)$size<-V(net)$Seats.Total*0.1
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
#V(net)$size<-V(net)$Seats.Total*0.5
#### Tolgo i label
V(net)$label<-V(net)$name
#### Setto lo spessore dei link in base al weight
E(net)$width<-E(net)$Seats.Total/10000
#### Cambio la dimensione delle frecce e il colore degli edge/link
E(net)$arrow.size<-.5
E(net)$edge.color<-"gray80"
#### Attenzione! Se la linea è troppo spessa non si vede la freccia
#E(net)$width<-1+E(net)$weight/12
plot(net,vertex.label.cex=.45)
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Snellire il network (cut-off di voli con pochi passeggeri)
head(edges2010)
hist(edges2010$Seats.Total,30, col=c("orange"), xlab="Passeggeri totali", ylab="Numero di tratte", main="Istrogramma dei passeggeri totali per tratta") # Seats Total
hist(edges2010$Frequency,30, col=c("orange"), xlab="Numero di voli", ylab="Numero di tratte", main="Isogramma della frequenza dei voli") # Frequency Total
hist(edges2010$Seats.Total/edges2020$Frequency,30, col=c("orange"), xlab="Passeggeri medi", ylab="Numero di tratte", main="Istogramma dei passeggeri medi")
mean(edges2010$Seats.Total) # Media 2093.368
sd(edges2010$Seats.Total) # Standard Deviation 3048.608
cut.off<-mean(edges2010$Seats.Total)
net.sp<-delete_edges(net,E(net)[Seats.Total<cut.off])
plot(net.sp,edge.color="orange",vertex.color="gray50",vertex.label.cex=.45)
#### Snellire il network (cut-off di voli con pochi passeggeri)
#### Genero colore in base al Region.Code
unique(nodes2010[,c("Region.Code")]) # Region.Code unici: "AF1" "AF3" "ME1" "EU1" "EU2" "NA1" "AS4"
#V(net)$type <- 404
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
cut.off<-mean(edges2010$Seats.Total)
net.sp<-delete_edges(net,E(net)[Seats.Total<cut.off])
plot(net.sp,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (Algeris (ALG) to AF3, EU2, ME1, NA1, AS4)
#### Voli verso regioni diverse da AF1 e EU1 gestiti solo da Algeris (ALG)
#### Notare un solo aeroporto in EU2 (Siviglia (SVQ))
net<-graph_from_data_frame(d=edges2010,vertices=nodes2010,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Arr.Region.Code=="AF1" | E(net)$Arr.Region.Code=="EU1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli verso regioni diverse da AF1 e EU1 gestiti solo da Algeris (ALG)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAF1)
#### Non ci sono voli la cui origine o destinazione non sia in AF1
net<-graph_from_data_frame(d=edges2010,vertices=nodes2010,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Non ci sono voli la cui origine o destinazione non sia in AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (onlyAF1)
#### Voli la cui origine e destinazione è AF1
net<-graph_from_data_frame(d=edges2010,vertices=nodes2010,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code!="AF1" | E(net)$Arr.Region.Code!="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine e destinazione è AF1")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAlgeris)
#### Voli la cui origine o destinazione non sia Algeris (ALG)
net<-graph_from_data_frame(d=edges2010,vertices=nodes2010,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Airport.Name=="Algiers" | E(net)$Arr.Airport.Name=="Algiers"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli la cui origine o destinazione non sia Algeris (ALG)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
q()
#### Mini (notAF1)
#### Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#############################################################################################################################################
####### Progetto Network Analysis (aa 2020-2021) - GRUPPO 7 SLOT 8 - Air Algerie (AH)
#############################################################################################################################################
############################
####### DATASET 2020 #######
############################
# Importo file nodes2020
## Windows
nodes2020 <- read.csv(file="C:/GitHub/unibg-ers/code/NODES_2020.csv", sep= ";", fileEncoding="UTF-8-BOM")
nodes2020
# Importo file edges2020
## Windows
edges2020 <- read.csv(file="C:/GitHub/unibg-ers/code/EDGES_2020.csv", sep= ";", fileEncoding="UTF-8-BOM")
edges2020
# ZOOM
library(zoom)
#zm()# Chiamare solo dopo aver plottato, per uscire cliccare 'q' sulla figura
# Esamino i dati
head(nodes2020) 
head(edges2020) 
nrow(nodes2020) # 73
length(unique(nodes2020$Airport.Code)) # Tutti i nodi sono unici
nrow(edges2020) # 329
nrow(unique(edges2020[,c("Dep.Airport.Code","Arr.Airport.Code")])) # Tutte le tratte sono uniche
### Rappresenazione grafica
library(igraph)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
class(net)
as_edgelist(net,names=T)
# Attenzione per network grandi può far saltare il programma as_adjacency_matrix(net,attr="weight")
as_data_frame(net,what="edges")
as_data_frame(net,what="vertices")
#### Plotto
plot(net,edge.arrow.size=.4,vertex.size=3,vertex.label.cex=.01)
plot(net,edge.arrow.size=.4,vertex.size=3,vertex.label.cex=.5)
plot(net,edge.arrow.size=.4,vertex.label=V(net)$name,vertex.size=3,vertex.label.cex=.5)
plot(net, edge.arrow.size=.4, vertex.shape="none", vertex.label=V(net)$name, vertex.size=3,vertex.label.font=2, vertex.label.color="gray40",vertex.label.cex=.5, edge.color="gray85")
#### Plotto con link curvi
plot(net,edge.arrow.size=.4,vertex.size=.9,edge.curved=.1,vertex.label.cex=.3)
#### Plotto con link non curvi e ridotta dimensione delle frecce
plot(net,edge.arrow.size=.2,edge.curved=0,vertex.color="orange",vertex.frame.color="#555555",vertex.label=V(net)$name,vertex.size=4.9,vertex.label.color="black",vertex.label.cex=.5)
#### Genero colore in base al Region.Code
unique(nodes2020[,c("Region.Code")]) # Region.Code unici: "AF1" "AF3" "ME1" "EU1" "EU2" "NA1" "AS4"
#V(net)$type <- 404
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
plot(net,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.size=10,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Setto la taglia dei nodi in base a size (es. dimensione aeroporto per seats totali nel network)
#V(net)$size<-V(net)$Seats.Total*0.1
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
#V(net)$size<-V(net)$Seats.Total*0.5
#### Tolgo i label
V(net)$label<-V(net)$name
#### Setto lo spessore dei link in base al weight
E(net)$width<-E(net)$Seats.Total/10000
#### Cambio la dimensione delle frecce e il colore degli edge/link
E(net)$arrow.size<-.5
E(net)$edge.color<-"gray80"
#### Attenzione! Se la linea è troppo spessa non si vede la freccia
#E(net)$width<-1+E(net)$weight/12
plot(net,vertex.label.cex=.45)
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Snellire il network (cut-off di voli con pochi passeggeri)
head(edges2020)
hist(edges2020$Seats.Total,30, col=c("lightskyblue1"), xlab="Passeggeri totali", ylab="Numero di tratte", main="Istrogramma dei passeggeri totali per tratta") # Seats Total
hist(edges2020$Frequency,30, col=c("lightskyblue1"), xlab="Numero di voli", ylab="Numero di tratte", main="Isogramma della frequenza dei voli") # Frequency Total
hist(edges2020$Seats.Total/edges2020$Frequency,30, col=c("lightskyblue1"), xlab="Passeggeri medi", ylab="Numero di tratte", main="Istogramma dei passeggeri medi")
mean(edges2020$Seats.Total) # Media 2511.198
sd(edges2020$Seats.Total) # Standard Deviation 3513.872
cut.off<-mean(edges2020$Seats.Total)
net.sp<-delete_edges(net,E(net)[Seats.Total<cut.off])
plot(net.sp,edge.color="lightskyblue1",vertex.color="gray50",vertex.label.cex=.45)
#### Snellire il network (cut-off di voli con pochi passeggeri)
#### Genero colore in base al Region.Code
unique(nodes2020[,c("Region.Code")]) # Region.Code unici: "AF1" "AF3" "ME1" "EU1" "EU2" "NA1" "AS4"
#V(net)$type <- 404
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
cut.off<-mean(edges2020$Seats.Total)
net.sp<-delete_edges(net,E(net)[Seats.Total<cut.off])
plot(net.sp,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Separare i due tipi di link in base alla regione dell'aeroporto di destinazione
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
net_africa <- net - E(net)[E(net)$Arr.Region.Code=="EU1" | E(net)$Arr.Region.Code=="EU2" | E(net)$Arr.Region.Code=="NA1" | E(net)$Arr.Region.Code=="AS4"]
net_extra_africa <- net - E(net)[E(net)$Arr.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF2" | E(net)$Arr.Region.Code=="ME1"]
par(mfrow=c(1,2))
plot(net_africa,vertex.color="orange",vertex.label.cex=.5,edge.arrow.size=.2,main="Tie: Africa")
plot(net_extra_africa,vertex.color="lightskyblue1",vertex.label.cex=.5,edge.arrow.size=.2,main="Tie: Extra Africa")
#### Mini (Algeris (ALG) to AF3, EU2, ME1, NA1, AS4)
#### Voli verso regioni diverse da AF1 e EU1 gestiti da più aeroporti africani
#### Notare un solo aeroporto in EU2 (Siviglia (SVQ))
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Arr.Region.Code=="AF1" | E(net)$Arr.Region.Code=="EU1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Voli verso regioni diverse da AF1 e EU1 gestiti da più aeroporti africani")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAF1)
#### Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
#### Mini (notAF1)
#### Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)
net<-graph_from_data_frame(d=edges2020,vertices=nodes2020,directed=T)
E(net)$width<-2.0
#V(net)$label<-NA
V(net)$type[V(net)$Region.Code=="AF1"] <- 1 # North Africa
V(net)$type[V(net)$Region.Code=="AF3"] <- 2 # Central/Western Africa
V(net)$type[V(net)$Region.Code=="ME1"] <- 3 # Middle East
V(net)$type[V(net)$Region.Code=="EU1"] <- 4 # Western Europe
V(net)$type[V(net)$Region.Code=="EU2"] <- 5 # Eastern/Central Europe
V(net)$type[V(net)$Region.Code=="NA1"] <- 6 # North America
V(net)$type[V(net)$Region.Code=="AS4"] <- 7 # North East Asia
V(net)$type
colrs<-c("orange","yellow","green","blue","sky blue","red","purple")
V(net)$color<-colrs[V(net)$type]
V(net)$size<-0.01*(log(V(net)$Seats.Total)^3+1)
net_mini <- net - E(net)[E(net)$Dep.Region.Code=="AF1" | E(net)$Arr.Region.Code=="AF1"]
plot(net_mini,edge.arrow.size=.2,edge.curved=0,vertex.label=V(net)$name,vertex.label.color="black",pt.bg=colrs,vertex.label.cex=.5,vertex.frame.color="white", main="Soltanto un volo la cui origine o destinazione non sia in AF1 (BUD-VIE)")
legend(x=-1.5, y=-1.1, c("North Africa","Central/Western Africa","Middle East","Western Europe","Eastern/Central Europe","North America","North East Asia"), pch=21,col="#777777", pt.bg=colrs, pt.cex=2, cex=.8, bty="n", ncol=1)
q()
